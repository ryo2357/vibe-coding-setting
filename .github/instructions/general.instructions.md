---
applyTo: "**"
---

# 前提

- chat の対話相手は日本人です。説明は**必ず日本語**で行ってください。

# 開発ワークフロー

## 基本方針

このプロジェクトでは、Copilotによる構造化された仕様書管理と効率的な実装を組み合わせた開発を行います。

## 開発フローの原則

### 1. 仕様書ファースト開発

すべての実装は以下の順序で進行します：

1. **requirement確認・更新**: `.doc/specs/requirements.md`
2. **design確認・更新**: `.doc/specs/design.md`
3. **プラン作成**: 仕様書を参照したコーディング計画
4. **実装**: プランに基づく段階的実装

### 2. 仕様書参照の必須化

#### 新機能追加時
- requirements.mdに該当する要件が存在するか確認
- 存在しない場合は、実装前にrequirements.md更新
- design.mdの既存アーキテクチャとの整合性確認
- 必要に応じてdesign.md更新

#### 既存機能修正時
- 該当するrequirements.mdのセクション特定
- design.mdの関連する設計パターン確認
- 修正が仕様書の更新を伴うかどうか判定

## Copilot利用時のルール

`.github\prompts\vibe\idea_to_spec_and_plan.prompt.md`と`.github\prompts\vibe\execute_plan.prompt.md`を使用して実装を行う。
基本的な考え方を書きに示す。

### プラン作成時

1. 必ず `.doc/specs/` 内の仕様書を参照
2. 仕様書更新の必要性を判定・実行
3. プランファイルに仕様書との対応関係を明記

### 仕様書更新時

1. requirements.mdを更新
2. design.mdを更新
3. 既存要件・設計との整合性を必ず確認
4. 更新内容の影響範囲を分析・文書化

### 実装時

1. プランファイルの手順に従って段階的実装
2. 各実装ステップで対応する仕様書セクションを参照
3. 実装後に仕様書との整合性を確認
4. 必要に応じて仕様書にフィードバック

## 品質保証チェックポイント

### 実装前チェック

- [ ] requirements.mdに対応する要件が存在する
- [ ] design.mdの設計パターンに従っている
- [ ] 既存の仕様書との矛盾がない
- [ ] プランファイルに仕様書参照情報が明記されている

### 実装後チェック

- [ ] requirements.mdの受け入れ基準を満たしている
- [ ] design.mdの実装パターンに沿っている
- [ ] 新たな仕様書更新の必要性がない
- [ ] 既存機能への影響がないことを確認


## ファイル構成・命名規則

### 仕様書ファイル

```
.doc/specs/
├── requirements.md  # ユーザーストーリー・受け入れ基準
└── design.md       # 技術設計・アーキテクチャ
```

### プランファイル
```
.doc/plans/
└── XXX_<機能名>.md
```

### アイディアファイル
```
.github/vibe/ideas/
└── XXX_<機能名>_idea.md
```

## 仕様書詳細説明

### requirements.md（要件定義書）

要件定義書は、プロジェクトで実現すべき機能やユーザーニーズを構造化して記述するドキュメントです。

#### 構成要素

1. **はじめに**
   - プロジェクトの概要と背景
   - 既存システムとの関係性
   - 追加・変更予定の機能概要

2. **要件セクション**
   - **ユーザーストーリー**: "〜として、〜したい、なぜなら〜"の形式で記述
   - **受け入れ基準**: WHEN-THEN-SHALL形式での具体的な動作仕様
   - 各要件には一意の番号を付与（要件1、要件2...）

3. **非機能要件**
   - パフォーマンス要件
   - セキュリティ要件
   - 利用性要件

#### 記述パターン例

```markdown
### 要件 1

**ユーザーストーリー:** カードゲームプレイヤーとして、複数の評価基準から選択してクイズに挑戦したい。これにより、様々な観点からカードの価値を学習できる。

#### 受け入れ基準

1. WHEN ユーザーがアプリを起動する THEN システムは評価値選択メニューを表示する SHALL
2. WHEN 評価値選択メニューが表示される THEN システムは 10 種類の評価基準を表示する SHALL
```

### design.md（設計書）

設計書は、requirements.mdで定義された要件を技術的にどう実現するかを詳細に記述するドキュメントです。

#### 構成要素

1. **概要**
   - システムの技術的な全体像
   - 既存システムとの関係性
   - 実装予定のコンポーネント概要

2. **アーキテクチャ**
   - システム全体の構造設計
   - 既存コンポーネントの活用方針
   - 新規追加コンポーネントの配置

3. **コンポーネントとインターフェース**
   - 各クラス・ウィジェットの詳細設計
   - メソッドシグネチャとパラメータ
   - 状態管理の方針

4. **データ構造**
   - モデルクラスの定義
   - JSON構造の仕様
   - データの流れと変換

5. **UI/UX設計**
   - 画面構成とレイアウト
   - ユーザーインタラクションパターン
   - アニメーションや視覚的フィードバック

#### 仕様書間の関係性

- **requirements.md → design.md**: 各要件に対応する技術実装方針を明記
- **design.md**: 要件実現のための具体的なクラス設計・UI設計を詳述
- **相互参照**: 実装時は両方を参照して一貫性を保持

## トラブルシューティング

### 仕様書と実装の齟齬が発生した場合

1. 実装を停止
2. 仕様書の該当セクションを確認
3. 齟齬の原因を分析（仕様書不備 vs 実装ミス）
4. 適切な修正（仕様書更新 or 実装修正）を実行

### 既存機能への影響が懸念される場合

1. design.mdで影響範囲を分析
2. requirements.mdで関連要件を確認
3. 必要に応じて段階的実装プランに変更
4. テスト計画の見直し・強化

## 継続的改善

- 開発フロー実行後のふりかえり実施
- 仕様書とプロンプトの改善点抽出
- ベストプラクティスの蓄積・共有
- ワークフロー効率化の検討

## アイディアファイルとプランファイルの仕様

### アイディアファイル（.doc/ideas/）

アイディアファイルは、新機能や改修に関する初期の着想やコンセプトを記録するファイルです。

#### 構成要素

1. **基本情報**
   - 作成日時: YYYY-MM-DD:HH:MM形式

2. **概要**
   - 実現したい機能や修正内容の簡潔な説明
   - 問題の背景や目的の概要

3. **仕様**
   - 具体的な実装内容や動作仕様
   - 現状の問題点と期待する動作
   - 技術的な実装方針や制約事項

#### 命名規則
- ファイル名: `XXX_<機能名>_idea.md`
- XXXは3桁の連番（001, 002...）
- 機能名は英語のスネークケース

### プランファイル（.doc/plans/）

プランファイルは、アイディアを具体的な実装計画に落とし込んだファイルです。
プランファイルをもとに実装を行います。

#### 構成要素

1. **基本情報**
   - 作成日: YYYY-MM-DD形式
   - 参照アイディアファイル
   - 参照仕様書セクション

2. **概要と目標**
   - 実装する機能の詳細説明
   - 達成すべき具体的な目標
   - 仕様書との対応関係

3. **実装手順**
   - フェーズ別の詳細ステップ
   - 各ステップでの成果物
   - ビルド・テスト・動作確認の手順

4. **品質保証**
   - 各フェーズでの確認ポイント
   - requirements.mdとの整合性確認
   - design.mdとの整合性確認

#### 命名規則とファイル分割

**単一プランファイル**

- ファイル名: `XXX_<機能名>.md`
- XXXは3桁の連番（001, 002...）

**分割プランファイル**

- ファイル名: `XXX-YY_<機能名>_implementation.md`
- XXXは3桁の連番、YYは2桁の分割番号
- 例: `001-01_quiz_feature_implementation.md`

#### プラン分割の原則

1. **分割対象**
   - 実装手順が5ステップを超える場合
   - 複数の画面・コンポーネントにまたがる場合
   - ビルド・テスト・動作確認が複数回必要な場合

2. **分割指針**
   - `01-`: 基本設計・環境構築・初回ビルド確認
   - `02-`: コアデータモデル実装・単体テスト
   - `03-`: UI・画面表示機能・表示確認
   - `04-`: 操作・制御機能・操作テスト
   - `05-`: 拡張機能・最適化・総合テスト

3. **分割時の記述ルール**
   - 各プランファイルは独立して理解できるように記述
   - 前のプランファイルへの依存関係を明記
   - 全体の進捗状況（例: 3/5）を記載
   - 各手順の最後にビルド・動作確認を含める

#### プランファイルと仕様書の連携

1. **requirements.md参照**
   - 実装対象の要件番号を明記
   - 受け入れ基準との対応を確認
   - 新要件追加の必要性を判定

2. **design.md参照**
   - 実装対象のコンポーネント設計を参照
   - アーキテクチャとの整合性を確認
   - 設計変更の必要性を判定

3. **実装後のフィードバック**
   - 仕様書の更新が必要な箇所を特定
   - 実装中に発見した設計課題を記録
   - 次回プランへの改善点を蓄積